# 🛠️ Инструменты разработки (dev)

## Обзор

Модуль `dev` предоставляет инструменты для разработки SwiftDevBot, включая линтинг, тестирование, профилирование и отладку кода.

## Основные команды

### `python sdb dev lint --fix`

Проверяет код на соответствие стандартам и исправляет простые ошибки.

**Опции:**
- `--fix` - автоматическое исправление ошибок
- `--strict` - строгий режим проверки
- `--format` - форматирование кода
- `--ignore PATTERN` - игнорировать файлы

**Примеры:**

```bash
# Проверить код
python sdb dev lint

# Исправить ошибки автоматически
python sdb dev lint --fix

# Строгая проверка
python sdb dev lint --strict

# Форматирование кода
python sdb dev lint --format
```

**Результат:**
```
🔍 Проверка кода

📋 Анализ файлов:
   📊 Всего файлов: 150
   📊 Python файлов: 120
   📊 Конфигурационных файлов: 30
   📋 Статус: Проверяется...

📊 Результаты линтинга:

✅ Исправлено автоматически:
   ✅ Форматирование: 15 файлов
   ✅ Импорты: 8 файлов
   ✅ Отступы: 12 файлов
   ✅ Пробелы: 20 файлов

⚠️ Требует ручного исправления:
   ⚠️ Сложные ошибки: 3 файла
   ⚠️ Неиспользуемые переменные: 5
   ⚠️ Длинные строки: 8

📊 Статистика:
   ✅ Исправлено: 55 проблем
   ⚠️ Осталось: 16 проблем
   📊 Качество кода: 85%

📋 Рекомендации:
   🔧 Исправьте оставшиеся проблемы вручную
   📊 Настройте pre-commit hooks
   🔄 Регулярно выполняйте линтинг
```

### `python sdb dev test --coverage`

Запускает тесты с измерением покрытия кода.

**Опции:**
- `--coverage` - измерить покрытие
- `--unit` - только unit тесты
- `--integration` - только интеграционные тесты
- `--verbose` - подробный вывод
- `--parallel` - параллельное выполнение

**Примеры:**

```bash
# Запустить все тесты
python sdb dev test

# Тесты с покрытием
python sdb dev test --coverage

# Только unit тесты
python sdb dev test --unit

# Параллельное выполнение
python sdb dev test --parallel
```

**Результат:**
```
🧪 Запуск тестов

📋 Настройки тестирования:
   📊 Тип: Все тесты
   📊 Покрытие: Включено
   📊 Параллельность: 4 процесса
   📋 Статус: Выполняется...

📊 Результаты тестирования:

✅ Unit тесты:
   ✅ cli/ - 45 тестов (100% успешно)
   ✅ core/ - 32 теста (100% успешно)
   ✅ modules/ - 28 тестов (100% успешно)
   ✅ utils/ - 15 тестов (100% успешно)

✅ Интеграционные тесты:
   ✅ API тесты - 12 тестов (100% успешно)
   ✅ БД тесты - 8 тестов (100% успешно)
   ✅ Бэкап тесты - 5 тестов (100% успешно)

📊 Покрытие кода:
   📈 Общее покрытие: 85%
   📈 cli/: 90%
   📈 core/: 88%
   📈 modules/: 82%
   📈 utils/: 85%

📊 Статистика:
   ✅ Всего тестов: 145
   ✅ Успешных: 145
   ❌ Неудачных: 0
   📊 Время выполнения: 45 секунд

📋 Рекомендации:
   ✅ Все тесты прошли успешно
   📊 Покрытие выше целевого (80%)
   🔧 Добавьте тесты для непокрытых участков
```

### `python sdb dev docs --build`

Строит документацию проекта.

**Опции:**
- `--build` - построить документацию
- `--serve` - запустить локальный сервер
- `--format html/pdf` - формат документации
- `--clean` - очистить старую документацию

**Примеры:**

```bash
# Построить документацию
python sdb dev docs --build

# Запустить локальный сервер
python sdb dev docs --serve

# Построить в PDF
python sdb dev docs --build --format pdf

# Очистить и перестроить
python sdb dev docs --build --clean
```

**Результат:**
```
📚 Построение документации

📋 Настройки сборки:
   📊 Тип: HTML документация
   📊 Источники: docstrings, markdown
   📊 Тема: Read the Docs
   📋 Статус: Строится...

📊 Обработка файлов:
   ✅ Python модули: 25 файлов
   ✅ Markdown файлы: 15 файлов
   ✅ Конфигурация: 5 файлов
   ✅ Статические файлы: 10 файлов

✅ Документация успешно построена
📁 Файлы созданы:
   📄 index.html (главная страница)
   📄 api.html (API документация)
   📄 cli.html (CLI документация)
   📄 modules.html (модули)
   📄 tutorials.html (руководства)

📊 Статистика документации:
   📋 Страниц: 45
   📋 API endpoints: 25
   📋 CLI команды: 50
   📋 Примеры кода: 120

📋 Доступные форматы:
   📄 HTML: Интерактивная документация
   📄 PDF: Печатная версия
   📄 EPUB: Электронная книга

📋 Локальный сервер:
   🌐 URL: http://localhost:8000/docs
   📊 Автоперезагрузка: Включена
   📊 Поиск: Работает
```

### `python sdb dev debug --enable`

Включает режим отладки.

**Опции:**
- `--enable` - включить отладку
- `--disable` - отключить отладку
- `--level DEBUG/INFO/WARNING/ERROR` - уровень отладки
- `--log-file FILE` - файл для логов

**Примеры:**

```bash
# Включить отладку
python sdb dev debug --enable

# Отключить отладку
python sdb dev debug --disable

# Установить уровень отладки
python sdb dev debug --enable --level DEBUG

# Логи в файл
python sdb dev debug --enable --log-file debug.log
```

**Результат:**
```
🐛 Настройка режима отладки

📋 Включение отладки:
   📊 Уровень: DEBUG
   📊 Логирование: В файл
   📊 Файл логов: debug.log
   📋 Статус: Настраивается...

✅ Режим отладки включен
📊 Настройки:
   📊 Уровень логирования: DEBUG
   📊 Вывод в консоль: Включен
   📊 Файл логов: debug.log
   📊 Максимальный размер: 10MB

📋 Включенные функции:
   ✅ Подробные логи
   ✅ Stack traces
   ✅ Переменные окружения
   ✅ SQL запросы
   ✅ HTTP запросы
   ✅ Производительность

📋 Рекомендации:
   ⚠️ Отладка влияет на производительность
   📊 Используйте только для разработки
   🔧 Отключите в продакшене
   📋 Проверяйте размер логов
```

### `python sdb dev profile --memory/cpu`

Профилирует производительность кода.

**Опции:**
- `--memory` - профилирование памяти
- `--cpu` - профилирование CPU
- `--time` - профилирование времени
- `--output FILE` - файл для результатов

**Примеры:**

```bash
# Профилирование памяти
python sdb dev profile --memory

# Профилирование CPU
python sdb dev profile --cpu

# Профилирование времени
python sdb dev profile --time

# Сохранить результаты
python sdb dev profile --memory --output profile.html
```

**Результат:**
```
📊 Профилирование производительности

📋 Тип профилирования: Memory
📊 Длительность: 60 секунд
📊 Точность: Высокая
📋 Статус: Выполняется...

📊 Результаты профилирования:

📈 Использование памяти:
   📊 Пиковое использование: 150MB
   📊 Среднее использование: 120MB
   📊 Утечки памяти: 0
   📊 Фрагментация: 5%

📊 Топ функций по памяти:
   📊 backup.create(): 25MB
   📊 db.optimize(): 20MB
   📊 cache.warm(): 15MB
   📊 monitor.collect(): 10MB

📊 Рекомендации по оптимизации:
   ✅ Память используется эффективно
   ⚠️ Рассмотрите кэширование для backup.create()
   🔧 Оптимизируйте db.optimize() для больших БД
   📊 Мониторьте использование при росте нагрузки

📊 Детальный отчет:
   📄 profile_memory_20240115_143522.html
   📊 Размер файла: 2.1MB
   📊 Время создания: 60 секунд
   📊 Точность: 99.5%
```

## Расширенные команды (в разработке)

### `python sdb dev analyze --code`

Анализ качества кода.

**Опции:**
- `--code` - анализ кода
- `--complexity` - анализ сложности
- `--security` - анализ безопасности
- `--performance` - анализ производительности

**Примеры:**

```bash
# Анализ кода
python sdb dev analyze --code

# Анализ сложности
python sdb dev analyze --complexity

# Анализ безопасности
python sdb dev analyze --security
```

**Результат:**
```
🔍 Анализ качества кода

📋 Анализ кода:
   📊 Файлов проанализировано: 150
   📊 Строк кода: 25,000
   📊 Сложность: Средняя
   📋 Статус: Анализируется...

📊 Результаты анализа:

📈 Метрики качества:
   📊 Цикломатическая сложность: 3.2 (хорошо)
   📊 Поддерживаемость: 85% (хорошо)
   📊 Надежность: 92% (отлично)
   📊 Безопасность: 88% (хорошо)

📊 Проблемы найдены:
   ⚠️ Высокая сложность: 5 функций
   ⚠️ Длинные функции: 8 функций
   ⚠️ Дублирование кода: 3 блока
   ⚠️ Неиспользуемые импорты: 12

📊 Рекомендации:
   🔧 Разбейте сложные функции на простые
   🔧 Удалите неиспользуемые импорты
   🔧 Используйте DRY принцип
   📊 Общее качество: Хорошее

📋 Детальный отчет:
   📄 code_analysis_20240115_143522.html
   📊 Размер файла: 1.8MB
   📊 Время анализа: 30 секунд
```

### `python sdb dev benchmark --run`

Запуск бенчмарков.

**Опции:**
- `--run` - запустить бенчмарки
- `--compare` - сравнить с предыдущими
- `--suite SUITE` - конкретный набор тестов
- `--iterations N` - количество итераций

**Примеры:**

```bash
# Запустить все бенчмарки
python sdb dev benchmark --run

# Сравнить с предыдущими
python sdb dev benchmark --compare

# Конкретный набор
python sdb dev benchmark --run --suite database
```

**Результат:**
```
⚡ Запуск бенчмарков

📋 Настройки бенчмарков:
   📊 Набор тестов: Все
   📊 Итераций: 1000
   📊 Время выполнения: 5 минут
   📋 Статус: Выполняется...

📊 Результаты бенчмарков:

🚀 Производительность:
   📊 Бэкап (1GB): 45 секунд
   📊 Оптимизация БД: 12 секунд
   📊 Кэширование: 0.5 секунды
   📊 API запрос: 2ms

📈 Сравнение с предыдущими:
   📊 Бэкап: +15% быстрее
   📊 Оптимизация БД: +8% быстрее
   📊 Кэширование: Без изменений
   📊 API запрос: +5% быстрее

📊 Рекомендации:
   ✅ Производительность улучшилась
   🔧 Оптимизируйте кэширование
   📊 Мониторьте производительность
   🔄 Регулярно запускайте бенчмарки

📋 Детальный отчет:
   📄 benchmark_results_20240115_143522.json
   📊 Размер файла: 500KB
   📊 Время выполнения: 5 минут
   📊 Точность: 99.9%
```

### `python sdb dev migrate --code`

Миграция кода между версиями.

**Опции:**
- `--code` - миграция кода
- `--config` - миграция конфигурации
- `--data` - миграция данных
- `--dry-run` - показать что будет изменено

**Примеры:**

```bash
# Миграция кода
python sdb dev migrate --code

# Миграция конфигурации
python sdb dev migrate --config

# Показать изменения
python sdb dev migrate --code --dry-run
```

**Результат:**
```
🔄 Миграция кода

📋 Тип миграции: Код
📊 Версия источника: 1.0.0
📊 Версия назначения: 1.1.0
📋 Статус: Выполняется...

📊 Анализ изменений:
   📊 Файлов для миграции: 25
   📊 Изменений в API: 3
   📊 Новых функций: 8
   📊 Удаленных функций: 2

📊 Выполненные миграции:
   ✅ Обновлены импорты: 15 файлов
   ✅ Изменены вызовы API: 8 файлов
   ✅ Добавлены новые функции: 5 файлов
   ✅ Удалены устаревшие функции: 3 файла

✅ Миграция успешно завершена
📊 Статистика:
   📊 Файлов обработано: 25
   📊 Изменений: 45
   📊 Ошибок: 0
   📊 Время выполнения: 2 минуты

📋 Рекомендации:
   ✅ Проверьте мигрированный код
   📊 Запустите тесты после миграции
   🔧 Обновите документацию
   📋 Создайте бэкап перед миграцией
```

## Безопасность

### ❌ Критически опасные команды:
- `python sdb dev reset --all` - сбросит все настройки разработки
- `python sdb dev clean --force` - удалит все временные файлы

### ⚠️ Опасные команды:
- `python sdb dev lint --fix` - может изменить код
- `python sdb dev migrate` - может изменить код
- `python sdb dev debug --enable` - может повлиять на производительность

### ✅ Безопасные команды:
- `python sdb dev lint` - только проверяет код
- `python sdb dev test` - только запускает тесты
- `python sdb dev docs --build` - только строит документацию
- `python sdb dev profile` - только профилирует
- `python sdb dev analyze` - только анализирует

## Рекомендации

1. **Регулярное тестирование**: Запускайте тесты перед каждым коммитом
2. **Линтинг**: Используйте линтинг для поддержания качества кода
3. **Документация**: Обновляйте документацию при изменениях
4. **Профилирование**: Регулярно профилируйте критичные участки кода
5. **Отладка**: Используйте отладку только в разработке

## Устранение проблем

### Проблема: "Тесты не проходят"
```bash
# Запустить тесты с подробным выводом
python sdb dev test --verbose

# Запустить конкретный тест
python sdb dev test --unit

# Проверить покрытие
python sdb dev test --coverage
```

### Проблема: "Ошибки линтинга"
```bash
# Исправить автоматически
python sdb dev lint --fix

# Строгая проверка
python sdb dev lint --strict

# Проверить конкретный файл
python sdb dev lint --ignore "*.pyc"
```

### Проблема: "Медленная производительность"
```bash
# Профилирование CPU
python sdb dev profile --cpu

# Профилирование памяти
python sdb dev profile --memory

# Анализ кода
python sdb dev analyze --performance
```

## Инструменты разработки

### Линтинг
- **flake8**: Проверка стиля кода
- **black**: Форматирование кода
- **isort**: Сортировка импортов
- **mypy**: Проверка типов

### Тестирование
- **pytest**: Фреймворк тестирования
- **coverage**: Измерение покрытия
- **pytest-cov**: Интеграция с coverage
- **pytest-xdist**: Параллельное выполнение

### Профилирование
- **cProfile**: Профилирование CPU
- **memory_profiler**: Профилирование памяти
- **line_profiler**: Построчное профилирование
- **py-spy**: Визуальное профилирование

### Документация
- **Sphinx**: Генератор документации
- **Read the Docs**: Хостинг документации
- **MkDocs**: Альтернативный генератор
- **pdoc**: Автоматическая документация 