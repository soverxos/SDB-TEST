#!/bin/bash
# –°–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å–∞ VPN –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è SwiftDevBot

echo "üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ VPN –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è SwiftDevBot..."
echo "================================================="

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å systemd —Å–µ—Ä–≤–∏—Å–∞
echo "üìã –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–∞:"
sudo systemctl is-active --quiet swiftdevbot-vpn.service
if [ $? -eq 0 ]; then
    echo "‚úÖ VPN —Å–µ—Ä–≤–∏—Å –∞–∫—Ç–∏–≤–µ–Ω"
else
    echo "‚ùå VPN —Å–µ—Ä–≤–∏—Å –Ω–µ–∞–∫—Ç–∏–≤–µ–Ω"
    echo "–î–µ—Ç–∞–ª–∏:"
    sudo systemctl status swiftdevbot-vpn.service --lines=5 --no-pager
fi

# –ü—Ä–æ–≤–µ—Ä—è–µ–º VPN –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
echo ""
echo "üåê VPN –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å:"
if ip addr show tun1 >/dev/null 2>&1; then
    VPN_IP=$(ip addr show tun1 | grep -o 'inet [0-9.]*' | cut -d' ' -f2)
    echo "‚úÖ VPN –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∞–∫—Ç–∏–≤–µ–Ω (IP: $VPN_IP)"
else
    echo "‚ùå VPN –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –Ω–µ –Ω–∞–π–¥–µ–Ω"
fi

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤–Ω–µ—à–Ω–∏–π IP
echo ""
echo "üåç –í–Ω–µ—à–Ω–∏–π IP-–∞–¥—Ä–µ—Å:"
EXTERNAL_IP=$(curl -s --connect-timeout 5 https://icanhazip.com 2>/dev/null)
if [ $? -eq 0 ] && [ -n "$EXTERNAL_IP" ]; then
    echo "‚úÖ –í–Ω–µ—à–Ω–∏–π IP: $EXTERNAL_IP"
    if [ "$EXTERNAL_IP" = "31.202.91.112" ]; then
        echo "üéâ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ ASUS —Ä–æ—É—Ç–µ—Ä –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ!"
    else
        echo "‚ö†Ô∏è  IP –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –æ–∂–∏–¥–∞–µ–º–æ–º—É (31.202.91.112)"
    fi
else
    echo "‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –≤–Ω–µ—à–Ω–∏–π IP"
fi

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Ä–æ—É—Ç–µ—Ä–∞
echo ""
echo "üì° –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–≤—è–∑–∏ —Å —Ä–æ—É—Ç–µ—Ä–æ–º:"
if ping -c 1 -W 3 192.168.31.1 >/dev/null 2>&1; then
    echo "‚úÖ –†–æ—É—Ç–µ—Ä –¥–æ—Å—Ç—É–ø–µ–Ω (192.168.31.1)"
else
    echo "‚ùå –†–æ—É—Ç–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω"
fi

echo ""
echo "================================================="
echo "–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ $(date)"
